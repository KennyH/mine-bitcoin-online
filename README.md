# Bitcoin Browser Miner

[![Website](https://img.shields.io/website?down_message=offline&label=Dev%20Site&up_message=online&url=https%3A%2F%2Fdev-env.bitcoinbrowserminer.com)](https://dev-env.bitcoinbrowserminer.com)
[![Website](https://img.shields.io/website?down_message=offline&label=Prod%20Site&up_message=planned&url=https%3A%2F%2Fbitcoinbrowserminer.com)](https://bitcoinbrowserminer.com)
[![License: Apache 2.0](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)

Mine Bitcoin (and testnet/regtest variants) directly in your web browser using WebAssembly, powered by block templates from a private Bitcoin node.

## Key Features

*   Browser-Based Mining: Uses WebAssembly (WASM) running in Web Workers for efficient background mining.
*   Multi-Network Support: Connect and mine on Bitcoin Mainnet, Testnet, or a local Regtest network.
*   Private Node Backend: Block templates are generated by a secure, self-hosted Raspberry Pi Bitcoin node.
*   Cloud-Powered Distribution: Uses AWS services (IoT, SQS, Lambda, S3, CloudFront, KMS) for scalable and secure work distribution and verification.
*   Passwordless Login: Simple and secure email OTP login via AWS Cognito.
*   Open Source: Community contributions are welcome!

## Current Status (Actively Under Development)

*   Dev Environment: The development website is live at [dev-env.bitcoinbrowserminer.com](https://dev-env.bitcoinbrowserminer.com). It currently features the basic layout and passwordless email login.
*   Production Environment: The production site at [bitcoinbrowserminer.com](https://bitcoinbrowserminer.com) is planned but not yet deployed.
*   Core Infrastructure:
    *   Raspberry Pi Bitcoin node setup is complete for Mainnet, Testnet, and Regtest.
    *   Initial AWS infrastructure for user authentication (Cognito) is in place.
    *   Static website hosting strategy is defined [ADR-004](./docs/adr/ADR-004-static-website-hosting-strategy.md).
*   Next Steps: Focus is on building out the core mining pipeline: template distribution from Pi to cloud, work unit management via SQS, WASM miner implementation, and solution verification/submission. See the [To Do List](#to-do-list-high-level) below.

## How it Works (High-Level)

1.  Template Generation: A Raspberry Pi running Bitcoin Core generates block templates for the selected network (Mainnet, Testnet, Regtest).
2.  Secure Distribution: The Pi securely sends essential template data to AWS.
3.  Cloud Processing: AWS Lambda functions process the template, sign critical data using KMS, store it on S3 (served via CloudFront), create work units (ranges of nonces) in SQS queues, and notify clients via AWS IoT Core (MQTT).
4.  Browser Mining:
    *   Logged-in users connect to AWS IoT and SQS using temporary credentials (via Cognito).
    *   The browser receives notifications for new templates and fetches work units from SQS.
    *   A Web Worker runs a Rust-based WASM module to perform the hashing calculations (SHA256d) without blocking the UI.
5.  Solution Submission: If a valid hash is found, the browser submits the solution to an API Gateway endpoint.
6.  Verification: A Lambda function verifies the solution's authenticity (using the KMS signature) and basic validity before placing it on a submission queue.
7.  Final Submission: The Raspberry Pi picks up verified solutions from the queue, reconstructs the full block, and submits it to its `bitcoind` instance.

*(For detailed architecture, see [ADR-001](./docs/adr/ADR-001-candidate-block-publishing-and-notification.md) and [ADR-003](./docs/adr/ADR-003-browser-miner-implementation.md))*

## Technology Stack

*   Frontend: Next.js 15.2+ (Static Export), React, TypeScript, Tailwind CSS
*   Mining Core: Rust compiled to WebAssembly (WASM)
*   Backend & Infrastructure: AWS (Cognito, IoT Core, SQS, Lambda, S3, CloudFront, KMS, SES), Raspberry Pi (Bitcoin Core), Terraform
*   Database: Encrypted SQLite (on Pi for recent templates), DynamoDB (for submission tracking)

## Getting Started (Development)

*(Instructions for setting up a local development environment are here)*

1.  Prerequisites:
    *   Node.js (check `.nvmrc`) & NPM
    *   Rust Toolchain (`rustup`, `wasm-pack`)
    *   AWS Account & setup OIDC base and/or CLI configured (for deploying/testing cloud components)
    *   Docker (optional, for local testing/services)
    *   Access to a Bitcoin node (Mainnet, Testnet, or Regtest) - local or the project's Pi setup.
2.  Clone the repository:
    ```bash
    git clone https://github.com/your-username/mine-bitcoin-online.git
    cd mine-bitcoin-online
    ```
3.  Install dependencies:
    ```bash
    npm install
    ```
4.  Configure environment variables:
    *   Copy `.env.example` to `.env.local` and fill in the required values (AWS region, Cognito IDs, API endpoints, etc.).
5.  Build WASM module:
    ```bash
    # (Command to build the Rust WASM package TBD)
    ```
6.  Run the development server:
    ```bash
    npm run dev
    ```

## Architecture Decisions (ADRs)

We use Architecture Decision Records (ADRs) to document significant architectural choices. You can find them in the [`docs/adr`](./docs/adr/) directory.

*   [ADR-001](./docs/adr/ADR-001-candidate-block-publishing-and-notification.md): Candidate Block Publishing and Notification Flow (Pi -> AWS -> Browser).
*   [ADR-002](./docs/adr/ADR-002-block-reward-distribution-and-user-payout.md): Phased Block Reward Distribution Strategy (Manual -> Multisig -> Smart Contract).
*   [ADR-003](./docs/adr/ADR-003-browser-miner-implementation.md): Initial Browser Miner Implementation (Web Worker + Single-Threaded WASM).
*   [ADR-004](./docs/adr/ADR-004-static-website-hosting-strategy.md): Static Website Hosting on AWS S3/CloudFront.

## To Do List (High-Level)

This is a summary of major remaining workstreams derived from the original notes:

- [ ] **Core Mining Pipeline:**
    - [ ] Implement Pi -> Cloud template upload logic.
    - [ ] Build AWS Lambda functions for template processing, signing, SQS population.
    - [ ] Develop WASM CPU miner module (Rust).
    - [ ] Integrate WASM miner into the frontend via Web Workers.
    - [ ] Implement SQS work unit fetching/management in the browser.
    - [ ] Build solution verification Lambda and submission API.
    - [ ] Implement Pi logic for polling submission queue and submitting to `bitcoind`.
- [ ] **Frontend Enhancements:**
    - [ ] Visualizations for mining progress (block template, hash rate).
    - [ ] Throttle control for mining intensity.
    - [ ] FAQ page.
    - [ ] UI feedback for block solve/verification events.
    - [ ] Modernize eductional tools, inspired by Anders Brownworth (e.g. [vid1](https://www.youtube.com/watch?v=_160oMzblY8), [vid2](https://www.youtube.com/watch?v=xIDL_akeras))
- [ ] **Infrastructure & Operations:**
    - [ ] Automated setup script for new Raspberry Pi nodes.
    - [ ] AWS IoT integration for Pi management/monitoring.
    - [ ] Database backup and lifecycle management.
    - [ ] GDPR compliance features (consent, data management).
    - [ ] Production deployment pipeline.
- [ ] **Future / Exploration:**
    - [ ] Setup ETH node for Smart Contracts
    - [ ] WASM GPU solver.
    - [ ] Multi-threaded WASM mining.
    - [ ] Explore alternative fleet management

## Contributing

Contributions are welcome! Please read our `CONTRIBUTING.md` (TBD) for guidelines on how to submit issues, feature requests, and pull requests.

## License

This project is licensed under the [Apache 2.0](./LICENSE).

## Contact

For questions or inquiries, please contact [info@bitcoinbrowserminer.com](mailto:info@bitcoinbrowserminer.com). You can also open an issue on GitHub.
